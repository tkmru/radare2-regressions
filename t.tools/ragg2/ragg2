#!/bin/sh

for a in . .. ../.. ; do [ -e $a/tests.sh ] && . $a/tests.sh ; done

NAME='ragg2 -p A200 -d 50:0xccccccb'
CMDS='!ragg2 -p A200 -d 50:0xccccccb'
EXPECT='4141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141cbcccc0c4141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141
'
run_test

NAME='ragg2 -p A200 -d 50:0xcb'
CMDS='!ragg2 -p A200 -d 50:0xcb'
EXPECT='4141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141cb0000004141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141
'
run_test

NAME='ragg2 -p A10 -d 50:0xcb'
CMDS='!ragg2 -p A10 -d 50:0xcb'
EXPECT_ERR="Fuck this shit. Cant patch outside"
EXPECT='41414141414141414141
'
run_test

NAME='ragg2 -p A20 -w 10:cb'
CMDS='!ragg2 -p A20 -w 10:cb'
EXPECT='41414141414141414141cb414141414141414141
'
run_test

NAME='ragg2 -p A20 -D 10:33'
CMDS='!ragg2 -p A20 -D 10:33'
EXPECT='4141414141414141414121000000000000004141
'
run_test

NAME='ragg2 -p n2t2a2s2'
CMDS='!ragg2 -p n2t2a2s2'
EXPECT='00004141cccc9090
'
run_test

NAME='ragg2 -i exec -z -a x86 -b32'
CMDS='!ragg2 -i exec -z -k linux -a x86 -b32'
BROKEN=
EXPECT='"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80"
'
run_test

NAME='ragg2 -k linux -i exec  -a x86 -b32 -p n3N3'
CMDS='!ragg2 -k linux -i exec  -a x86 -b32 -p n3N3'
EXPECT='90909031c050682f2f7368682f62696e89e3505389e199b00bcd80909090
'
run_test


NAME="ragg2 -p n80 -w 79:c3 -x"
CMDS="!ragg2 -p n80 -w 79:c3 -x"
EXPECT=''
run_test


NAME='ragg2 -k linux -a x86 -b32 simple_cmp.r'
CMDS='!ragg2 -k linux -a x86 -b32 ../../bins/other/ragg2/simple_cmp.r'
EXPECT='5589e581ec80000000c745086869210ac7450c6e000000c74510000000008d4508898504000000c7450501000000c745060200000055583b45060f8f5a0000006a04546a018b1c248b8c24040000008b942408000000b804000000cd8083c40c6a008b1c24b801000000cd8083c40481c4800000005dc3
'
run_test

